# Historical Weather Application

## Requirements

- uv
- Python 3.11 or above

uv will install the following packages and their dependencies:

- Pandas
- pytest

## Usage
From the command line, use uv to run the program. For example:
```
uv run historical_weather.py -h
```

If this does not work, you may need to explicitly create the virtual environment and install dependencies first:
```bash
uv venv
source .venv/bin/activate
uv pip install -e .
```

Then try the run statement again.

The usage instructions are summed up by the results of running the script with the `-h` flag.
Note that it is not necessary to put `function_name` last. You can put it first as it was done in the project
instructions.

```bash
usage: historical_weather.py [-h] [-c CITY] [-y YEAR] [-m MONTH] [-f FILENAME] [-v] function_name

Perform a calculation on historical weather data: the greatest daily temperature change for a particular city, or
the average yearly days of precipitation for a particular city.

positional arguments:
  function_name         Required. Either max-temp-delta or days-of-precip

options:
  -h, --help            show this help message and exit
  -c CITY, --city CITY  Required. Which city to evaluate: bos, jnu, or mia
  -y YEAR, --year YEAR  (max-temp-delta only) Optional. Restrict search to a particular year in the range
                        2010-2019.
  -m MONTH, --month MONTH
                        (max-temp-delta only) Optional. Restrict search to a particular month in the range
                        1-12.) Requires a year.
  -f FILENAME, --filename FILENAME
                        Optional. Filename, defaults to data/noaa_historical_weather_10yr.csv
  -v, --verbose         Optional. Print more output than just the solution.
```
Examples:

Show the greatest daily temperature change for Boston in May of 2010:
```bash
$ uv run historical_weather.py max-temp-delta -c bos -y 2010 -m 5
max_temp_delta: 20.0
```
Show the average number of days of precipitation for Miami over the total ten-year period:
```bash
$ uv run historical_weather.py days-of-precip -c mia
days_of_precip: 144.8
````

## Tests

Unlike the main script, which I wrote mostly by hand with help from Claude Sonnet 3.5, I used Claude to generate the
unit tests. I prompted it for the test cases I wanted. Although they always need to be checked over, I think that unit
test generation (particularly for new code) is a great use case for LLMs.

To run the tests, install the development dependencies once:

```bash
uv pip install -e ".[dev]"
```

Then run the tests with:

```bash
uv run pytest test_historical_weather.py -v
```

## Use of Generative AI

The main file, `historical_weather.py`, was written mostly by hand. I used Claude Sonnet 3.5 in the Cody Plugin in
within Pycharm for some debugging and code completion.

The unit test file, `test_historical_weather.py`, was generated by Claude Sonnet 3.5. I used the Cody plugin in Pycharm
to generate the test cases I wanted. I then checked the output and made some minor edits.

## Design choices

- **Modules or one file?**  For such a small script, I decided to use a single file. As the script grows, I would review
  the structure and start breaking it into modules. In this script the code is generally grouped into input handling and
  calculations, so I would expect the first refactoring to organize the code along those lines.
- **Type hints?**  I like type hints. I didn't put them in to cut down on time spent on the assignment. I often find
  them helpful when reading large code bases to help me see where data flows in and out of methods and functions. For
  a short script like this where we have a good sense of the data types from the easy-to-understand numeric concepts (
  temperature and rainfall instead of, say, n-dimensional matrices of abstract values) I didn't prioritize it.
- **Rounding?**  I went with 1 decimal, since the input file seems to be to 1 decimal for the values used.
- **Pandas or just Python?**  I went out on a limb and assumed you use Pandas, and that I should show some basic
  understanding of it. This arithmetic could have been done with arrays and loops and avoided including the sizable
  Pandas library. However, there are a lot of succinct and reusable Pandas features, like the ability to import a CSV
  file in one line, and support for complicated data manipulation. Should this script be expanded, it's likely that
  those would be helpful.
- **Testing?**  I tested the code manually and compared the results to calculations performed in LibreOffice Calc. I
  then wrote a prompt for the Claude Sonnet 3.5 LLM to generate a unit test handling the following cases:
    - Arguments are parsed correctly
    - Bad arguments cause the program to exit without blowing up and give useful feedback
    - Calculations are correct
    - Null values in the incoming file are handled correctly (for precipitation and snow.)
    - I didn't test the filename override flag; try it at your peril.
- **Error Handling** Most of the error handling is handled by the argparse module and validate_args function. Had the
  instructions not included hardcoding this to a particular input file, I would have added more handling and unit tests
  to check the validity of the file, for missing columns or invalid data types, for example.
